node {
	def mvnHome
	sh "pwd > pathTmp" 
	PATH = readFile('pathTmp').trim()
	echo "PATH = ${PATH}"
	
    stage('Preparation') { // for display purposes
	  
      mvnHome = tool 'M3'
   }
   stage('Maven') {
      // Run the maven build
	  dir("retwisj"){
		  withEnv(["MVN_HOME=$mvnHome"]) {

			sh '"$MVN_HOME/bin/mvn" -Dmaven.test.failure.ignore clean package'

		  }
	  }
   }
   stage('Results') {
		dir("retwisj/target"){
			sh 'ls -lah *.war'
		}
		//junit 'TEST-.xml'
		//archiveArtifacts 'target/*.jar'

      
   }
   
   stage('Docker') {   
		echo "${PATH}"
		sh 'ls -lah'
		sh 'docker build -t ${PATH}/retwisj ${PATH}'
		echo 'docker'
   }

}